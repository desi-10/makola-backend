model Invite {
  id             String       @id @default(cuid())
  email          String
  storeId        String?
  organizationId String?
  roleId         String? // Store role or organization role
  token          String       @unique
  status         InviteStatus @default(PENDING)
  invitedBy      String // User ID
  expiresAt      DateTime
  acceptedAt     DateTime?
  isActive       Boolean      @default(true)
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt
  deletedAt      DateTime?

  store        Store?          @relation(fields: [storeId], references: [id])
  organization Organization?   @relation(fields: [organizationId], references: [id])
  history      InviteHistory[]

  @@index([token])
  @@index([email, storeId])
  @@index([email, organizationId])
  @@index([status])
  @@index([expiresAt])
  @@map("invites")
}

enum InviteStatus {
  PENDING
  ACCEPTED
  EXPIRED
  CANCELLED
}

model InviteHistory {
  id        String        @id @default(cuid())
  inviteId  String
  userId    String
  action    String
  status    InviteStatus?
  reason    String?
  ipAddress String?
  userAgent String?
  createdAt DateTime      @default(now())
  updatedAt DateTime      @updatedAt
  deletedAt DateTime?
  meta      Json?

  invite Invite @relation(fields: [inviteId], references: [id])
  user   User   @relation(fields: [userId], references: [id])

  @@index([inviteId, createdAt])
  @@map("invite_history")
}
